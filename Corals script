-------AN INNER JOIN WAS DONE BETWEEN WORLDSQ AND WORLD TABLE TO SEE IF WORLD TABLE
(WHICH DOESN'T HAVE GEOM) IS THE SAME AS WORLDSQ (WHICH HAS GEOM). SO WE CAN 
INTERSECT THE GEOMETRIES OF WORLD TABLE WITH THE CORAL SHAPEFILE

select a.gid, a.seq, b.cell_id, a.lat, a.lon, b.water_area, b.meow_id, a.geom
into temp table bard
from worldsq a
inner join world b on a.gid=b.cell_id; 


------A TABLE WAS CREATED TO HOUSE THE RESULT; NOTE THAT MEOW_ID IS A FLOAT NOT AN 
INTEGER. I SIMPLY FOLLOWED WHAT WAS ON WORLD TABLE. 

create table worldsq_x_world
(gid int4 null, seq int4 null, cell_id int4 null, lat float8 null, lon float8 null, 
water_area float8 null, meow_id float8 null, geom geometry null);

insert into worldsq_x_world
(gid, seq, cell_id, lat, lon, water_area, meow_id, geom)
select * from bard;

---THEN THE WORLDSQ_X_WORLD SHAPEFILE WAS INTERSECTED WITH UNEP-WCMC CORAL SHAPEFILE
AND THEN THE RESULTANT SHAPEFILE IS TO BE TRANSPOSED INTO PROJECTED SYSTEM SRID USING THE GEOM
SO AS TO COMPUTE FOR THE AREA. AND WE USE THE FOLLOWING SCRIPT FOR THIS:

select climate_zone, meow_id,
st_area(st_transform(geom,98287))/1000000 area
from climateandmeow2;


---YOU MUST ALSO USE THE FOLLOWING SYNTAX TO SUM ALL THE AREAS IN EACH CELL. 
SELECT
   WORLDSQ_GID,
   SUM (AREA)
FROM
   [TABLENAME]
GROUP BY
   WORLDSQ_GID;
